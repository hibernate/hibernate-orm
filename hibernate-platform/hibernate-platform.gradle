plugins {
    id "java-platform"
    id "local.module"
    id "local.publishing"
}

description = 'Platform (BOM) for Hibernate ORM dependencies'

dependencies {
    constraints {
        api project( ":hibernate-core" )
        api "org.hibernate:hibernate-core:$version"
        api project( ":hibernate-testing" )
        api "org.hibernate:hibernate-testing:$version"

        api project( ":hibernate-envers" )
        api "org.hibernate:hibernate-envers:$version"
        api project( ":hibernate-spatial" )
        api "org.hibernate:hibernate-spatial:$version"
        api project( ":hibernate-vector" )
        api "org.hibernate:hibernate-vector:$version"

        api project( ":hibernate-community-dialects" )
        api "org.hibernate:hibernate-community-dialects:$version"
        api project( ":hibernate-scan-jandex" )

        api project( ":hibernate-agroal" )
        api "org.hibernate:hibernate-agroal:$version"
        api project( ":hibernate-c3p0" )
        api "org.hibernate:hibernate-c3p0:$version"
        api project( ":hibernate-hikaricp" )
        api "org.hibernate:hibernate-hikaricp:$version"

        api project( ":hibernate-jcache" )
        api "org.hibernate:hibernate-jcache:$version"

        api project( ":hibernate-micrometer" )
        api "org.hibernate:hibernate-micrometer:$version"
        api project( ":hibernate-graalvm")
        api "org.hibernate:hibernate-graalvm:$version"

        api project( ":hibernate-processor" )
        api "org.hibernate:hibernate-processor:$version"
        api project( ":hibernate-gradle-plugin" )
        api project( ":hibernate-maven-plugin" )
        api project( ":hibernate-ant" )
        api "org.hibernate:hibernate-ant:$version"

        api project( ":hibernate-assistant" )
        api "org.hibernate:hibernate-assistant:$version"
        api project( ":hibernate-jfr" )
        api "org.hibernate:hibernate-jfr:$version"

        api libs.hibernateModels

        api jakartaLibs.jpa
        api jakartaLibs.jta
        api jakartaLibs.data

        runtime libs.antlrRuntime
        runtime libs.logging
        runtime libs.byteBuddy
        runtime libs.byteBuddyAgent
        runtime libs.jandex

        runtime jakartaLibs.jaxb
        runtime jakartaLibs.jaxbApi
        runtime jakartaLibs.inject


        // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        // todo : imo these are questionable
        runtime libs.agroal
        runtime libs.agroalPool
        runtime libs.c3p0
        runtime libs.hikaricp

        runtime libs.jcache

        runtime libs.micrometer
        // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    }
}


tasks.register("releasePrepare") {
    group = "release-prepare"
    description = "See :release:releasePrepare for details."

    dependsOn tasks.generateMetadataFileForPublishedArtifactsPublication
    dependsOn tasks.generatePomFileForPublishedArtifactsPublication
    dependsOn tasks.publishAllPublicationsToStagingRepository
}

var publishingExtension = project.getExtensions().getByType(PublishingExtension) as PublishingExtension
publishingExtension.publications.named("publishedArtifacts", MavenPublication) {
    from components.javaPlatform
}
